(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=10)})([function(module,exports){module.exports=__osdSharedDeps__.React},function(module,exports){module.exports=__osdSharedDeps__.ElasticEui},function(module,exports){module.exports=__osdSharedDeps__.Lodash},function(module,exports){module.exports=__osdSharedDeps__.OsdI18nReact},function(module,exports){module.exports=__osdSharedDeps__.OsdI18n},function(module,exports,__webpack_require__){"use strict";module.exports=function(cssWithMappingToString){var list=[];list.toString=function toString(){return this.map((function(item){var content=cssWithMappingToString(item);if(item[2]){return"@media ".concat(item[2]," {").concat(content,"}")}return content})).join("")};list.i=function(modules,mediaQuery,dedupe){if(typeof modules==="string"){modules=[[null,modules,""]]}var alreadyImportedModules={};if(dedupe){for(var i=0;i<this.length;i++){var id=this[i][0];if(id!=null){alreadyImportedModules[id]=true}}}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);if(dedupe&&alreadyImportedModules[item[0]]){continue}if(mediaQuery){if(!item[2]){item[2]=mediaQuery}else{item[2]="".concat(mediaQuery," and ").concat(item[2])}}list.push(item)}};return list}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__osdBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports,__webpack_require__){"use strict";var isOldIE=function isOldIE(){var memo;return function memorize(){if(typeof memo==="undefined"){memo=Boolean(window&&document&&document.all&&!window.atob)}return memo}}();var getTarget=function getTarget(){var memo={};return function memorize(target){if(typeof memo[target]==="undefined"){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[target]=styleTarget}return memo[target]}}();var stylesInDom=[];function getIndexByIdentifier(identifier){var result=-1;for(var i=0;i<stylesInDom.length;i++){if(stylesInDom[i].identifier===identifier){result=i;break}}return result}function modulesToDom(list,options){var idCountMap={};var identifiers=[];for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var count=idCountMap[id]||0;var identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier);var obj={css:item[1],media:item[2],sourceMap:item[3]};if(index!==-1){stylesInDom[index].references++;stylesInDom[index].updater(obj)}else{stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1})}identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style");var attributes=options.attributes||{};if(typeof attributes.nonce==="undefined"){var nonce=true?__webpack_require__.nc:undefined;if(nonce){attributes.nonce=nonce}}Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])}));if(typeof options.insert==="function"){options.insert(style)}else{var target=getTarget(options.insert||"head");if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")}target.appendChild(style)}return style}function removeStyleElement(style){if(style.parentNode===null){return false}style.parentNode.removeChild(style)}var replaceText=function replaceText(){var textStore=[];return function replace(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index]){style.removeChild(childNodes[index])}if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,options,obj){var css=obj.css;var media=obj.media;var sourceMap=obj.sourceMap;if(media){style.setAttribute("media",media)}else{style.removeAttribute("media")}if(sourceMap&&typeof btoa!=="undefined"){css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}var singleton=null;var singletonCounter=0;function addStyle(obj,options){var style;var update;var remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else{style=insertStyleElement(options);update=applyToTag.bind(null,style,options);remove=function remove(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}module.exports=function(list,options){options=options||{};if(!options.singleton&&typeof options.singleton!=="boolean"){options.singleton=isOldIE()}list=list||[];var lastIdentifiers=modulesToDom(list,options);return function update(newList){newList=newList||[];if(Object.prototype.toString.call(newList)!=="[object Array]"){return}for(var i=0;i<lastIdentifiers.length;i++){var identifier=lastIdentifiers[i];var index=getIndexByIdentifier(identifier);stylesInDom[index].references--}var newLastIdentifiers=modulesToDom(newList,options);for(var _i=0;_i<lastIdentifiers.length;_i++){var _identifier=lastIdentifiers[_i];var _index=getIndexByIdentifier(_identifier);if(stylesInDom[_index].references===0){stylesInDom[_index].updater();stylesInDom.splice(_index,1)}}lastIdentifiers=newLastIdentifiers}}},function(module,exports){module.exports=__osdSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__osdBundles__.get("plugin/opensearchDashboardsReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_inputControlVis_osd_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11);var _node_modules_val_loader_dist_cjs_js_key_inputControlVis_osd_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_inputControlVis_osd_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__osdBundles__.define("plugin/inputControlVis/public",__webpack_require__,25)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__osdPublicPath__["inputControlVis"]},function(module,exports,__webpack_require__){switch(window.__osdThemeTag__){case"v7dark":return __webpack_require__(13);case"v7light":return __webpack_require__(15);case"v8dark":return __webpack_require__(17);case"v8light":return __webpack_require__(19);case"v9dark":return __webpack_require__(21);case"v9light":return __webpack_require__(23)}},function(module,exports,__webpack_require__){var api=__webpack_require__(7);var content=__webpack_require__(14);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.icvControlEditor__panel{z-index:1;margin-bottom:16px}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},function(module,exports,__webpack_require__){var api=__webpack_require__(7);var content=__webpack_require__(16);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.icvControlEditor__panel{z-index:1;margin-bottom:16px}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},function(module,exports,__webpack_require__){var api=__webpack_require__(7);var content=__webpack_require__(18);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.icvControlEditor__panel{z-index:1;margin-bottom:16px}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},function(module,exports,__webpack_require__){var api=__webpack_require__(7);var content=__webpack_require__(20);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.icvControlEditor__panel{z-index:1;margin-bottom:16px}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},function(module,exports,__webpack_require__){var api=__webpack_require__(7);var content=__webpack_require__(22);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.icvControlEditor__panel{z-index:1;margin-bottom:16px}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},function(module,exports,__webpack_require__){var api=__webpack_require__(7);var content=__webpack_require__(24);content=content.__esModule?content.default:content;if(typeof content==="string"){content=[[module.i,content,""]]}var options={};options.insert="head";options.singleton=false;var update=api(content,options);module.exports=content.locals||{}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0__);var ___CSS_LOADER_EXPORT___=_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_0___default()((function(i){return i[1]}));___CSS_LOADER_EXPORT___.push([module.i,"/*!\n * SPDX-License-Identifier: Apache-2.0\n *\n * The OpenSearch Contributors require contributions made to\n * this file be licensed under the Apache-2.0 license or a\n * compatible open source license.\n *\n * Modifications Copyright OpenSearch Contributors. See\n * GitHub history for details.\n */\n\n.icvControlEditor__panel{z-index:1;margin-bottom:16px}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]);__webpack_exports__["default"]=___CSS_LOADER_EXPORT___},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var public_0=__webpack_require__(12);var external_osdSharedDeps_OsdI18n_=__webpack_require__(4);const createInputControlVisFn=()=>({name:"input_control_vis",type:"render",inputTypes:[],help:external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.function.help",{defaultMessage:"Input control visualization"}),args:{visConfig:{types:["string"],default:'"{}"',help:""}},fn(input,args){const params=JSON.parse(args.visConfig);return{type:"render",as:"visualization",value:{visType:"input_control_vis",visConfig:params}}}});var external_osdSharedDeps_React_=__webpack_require__(0);var external_osdSharedDeps_React_default=__webpack_require__.n(external_osdSharedDeps_React_);var external_osdSharedDeps_Lodash_=__webpack_require__(2);var external_osdSharedDeps_Lodash_default=__webpack_require__.n(external_osdSharedDeps_Lodash_);var external_osdSharedDeps_ReactDom_=__webpack_require__(8);var external_osdSharedDeps_ElasticEui_=__webpack_require__(1);var external_osdSharedDeps_OsdI18nReact_=__webpack_require__(3);const CONTROL_TYPES={LIST:"list",RANGE:"range"};const setControl=(controls,controlIndex,control)=>[...controls.slice(0,controlIndex),control,...controls.slice(controlIndex+1)];const addControl=(controls,control)=>[...controls,control];const moveControl=(controls,controlIndex,direction)=>{let newIndex;if(direction>=0){newIndex=controlIndex+1}else{newIndex=controlIndex-1}if(newIndex<0){return[...controls.slice(1),controls[0]]}else if(newIndex>=controls.length){const lastItemIndex=controls.length-1;return[controls[lastItemIndex],...controls.slice(0,lastItemIndex)]}else{const swapped=controls.slice();const temp=swapped[newIndex];swapped[newIndex]=swapped[controlIndex];swapped[controlIndex]=temp;return swapped}};const removeControl=(controls,controlIndex)=>[...controls.slice(0,controlIndex),...controls.slice(controlIndex+1)];const getDefaultOptions=type=>{const defaultOptions={};switch(type){case CONTROL_TYPES.RANGE:defaultOptions.decimalPlaces=0;defaultOptions.step=1;break;case CONTROL_TYPES.LIST:defaultOptions.type="terms";defaultOptions.multiselect=true;defaultOptions.dynamicOptions=true;defaultOptions.size=5;defaultOptions.order="desc";break}return defaultOptions};const newControl=type=>({id:(new Date).getTime().toString(),indexPattern:"",fieldName:"",parent:"",label:"",type:type,options:getDefaultOptions(type)});const getTitle=(controlParams,controlIndex)=>{let title=`${controlParams.type}: ${controlIndex}`;if(controlParams.label){title=`${controlParams.label}`}else if(controlParams.fieldName){title=`${controlParams.fieldName}`}return title};function FormRow(props){let control=props.children;if(props.disableMsg){control=external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:props.disableMsg,anchorClassName:"eui-displayBlock"},control)}const label=props.warningMsg?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiToolTip"],{position:"top",content:props.warningMsg},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiIcon"],{type:"alert"})),props.label):props.label;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{label:label,id:props.id,"data-test-subj":"inputControl"+props.controlIndex},control)}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class list_control_ListControlUi extends external_osdSharedDeps_React_["PureComponent"]{constructor(props){super(props);_defineProperty(this,"isMounted",false);_defineProperty(this,"state",{isLoading:false});_defineProperty(this,"textInput",void 0);_defineProperty(this,"componentDidMount",()=>{if(this.textInput){this.textInput.setAttribute("focusable","false")}this.isMounted=true});_defineProperty(this,"componentWillUnmount",()=>{this.isMounted=false});_defineProperty(this,"setTextInputRef",ref=>{this.textInput=ref});_defineProperty(this,"handleOnChange",selectedOptions=>{const selectedValues=selectedOptions.map(_ref=>{let{value:value}=_ref;return value});this.props.stageFilter(this.props.controlIndex,selectedValues)});_defineProperty(this,"debouncedFetch",external_osdSharedDeps_Lodash_default.a.debounce(async searchValue=>{if(this.props.fetchOptions){await this.props.fetchOptions(searchValue)}if(this.isMounted){this.setState({isLoading:false})}},300));_defineProperty(this,"onSearchChange",searchValue=>{this.setState({isLoading:true},this.debouncedFetch.bind(null,searchValue))});this.textInput=null}renderControl(){var _this$props$options;const{intl:intl}=this.props;if(this.props.disableMsg){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFieldText"],{"aria-label":intl.formatMessage({id:"inputControl.vis.listControl.selectTextPlaceholder",defaultMessage:"Select..."}),placeholder:intl.formatMessage({id:"inputControl.vis.listControl.selectTextPlaceholder",defaultMessage:"Select..."}),disabled:true})}const options=(_this$props$options=this.props.options)===null||_this$props$options===void 0?void 0:_this$props$options.map(option=>({label:this.props.formatOptionLabel(option).toString(),value:option,["data-test-subj"]:`option_${option.toString().replace(" ","_")}`})).sort((a,b)=>a.label.toLowerCase().localeCompare(b.label.toLowerCase()));const selectedOptions=this.props.selectedOptions.map(selectedOption=>({label:this.props.formatOptionLabel(selectedOption).toString(),value:selectedOption}));return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedComboBox"],{placeholder:intl.formatMessage({id:"inputControl.vis.listControl.selectPlaceholder",defaultMessage:"Select..."}),options:options,isLoading:this.state.isLoading,async:this.props.dynamicOptions,onSearchChange:this.props.dynamicOptions?this.onSearchChange:undefined,selectedOptions:selectedOptions,onChange:this.handleOnChange,singleSelection:!this.props.multiselect,"data-test-subj":`listControlSelect${this.props.controlIndex}`,inputRef:this.setTextInputRef})}render(){const partialResultsWarningMessage=external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.vis.listControl.partialResultsWarningMessage",{defaultMessage:"Terms list might be incomplete because the request is taking too long. "+"Adjust the autocomplete settings in opensearch_dashboards.yml for complete results."});return external_osdSharedDeps_React_default.a.createElement(FormRow,{id:this.props.id,label:this.props.label,warningMsg:this.props.partialResults?partialResultsWarningMessage:undefined,controlIndex:this.props.controlIndex,disableMsg:this.props.disableMsg},this.renderControl())}}_defineProperty(list_control_ListControlUi,"defaultProps",{dynamicOptions:false,multiselect:true,selectedOptions:[],options:[]});const list_control_ListControl=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(list_control_ListControlUi);var public_=__webpack_require__(9);function range_control_defineProperty(obj,key,value){key=range_control_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function range_control_toPropertyKey(arg){var key=range_control_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function range_control_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function roundWithPrecision(value,decimalPlaces,roundFunction){if(decimalPlaces<=0){return roundFunction(value)}let results=value;results=results*Math.pow(10,decimalPlaces);results=roundFunction(results);results=results/Math.pow(10,decimalPlaces);return results}function ceilWithPrecision(value,decimalPlaces){return roundWithPrecision(value,decimalPlaces,Math.ceil)}function floorWithPrecision(value,decimalPlaces){return roundWithPrecision(value,decimalPlaces,Math.floor)}class range_control_RangeControl extends external_osdSharedDeps_React_["PureComponent"]{constructor(){super(...arguments);range_control_defineProperty(this,"state",{});range_control_defineProperty(this,"onChangeComplete",external_osdSharedDeps_Lodash_default.a.debounce(value=>{const controlValue={min:value[0],max:value[1]};this.props.stageFilter(this.props.controlIndex,controlValue)},200))}static getDerivedStateFromProps(nextProps,prevState){const nextValue=nextProps.control.hasValue()?[nextProps.control.value.min,nextProps.control.value.max]:["",""];if(nextProps.control.hasValue()&&nextProps.control.value.min==null){nextValue[0]=""}if(nextProps.control.hasValue()&&nextProps.control.value.max==null){nextValue[1]=""}if(nextValue!==prevState.prevValue){return{value:nextValue,prevValue:nextValue}}return null}renderControl(){if(!this.props.control.isEnabled()){return external_osdSharedDeps_React_default.a.createElement(public_["ValidatedDualRange"],{disabled:true,showInput:true,formRowDisplay:"rowCompressed"})}const decimalPlaces=external_osdSharedDeps_Lodash_default.a.get(this.props,"control.options.decimalPlaces",0);const min=floorWithPrecision(this.props.control.min,decimalPlaces);const max=ceilWithPrecision(this.props.control.max,decimalPlaces);const ticks=[{value:min,label:min},{value:max,label:max}];return external_osdSharedDeps_React_default.a.createElement(public_["ValidatedDualRange"],{id:this.props.control.id,min:min,max:max,formRowDisplay:"rowCompressed",value:this.state.value,onChange:this.onChangeComplete,showInput:true,showRange:true,showTicks:true,ticks:ticks})}render(){return external_osdSharedDeps_React_default.a.createElement(FormRow,{id:this.props.control.id,label:this.props.control.label,controlIndex:this.props.controlIndex,disableMsg:this.props.control.isEnabled()?undefined:this.props.control.disabledReason},this.renderControl())}}function isListControl(control){return control.type===CONTROL_TYPES.LIST}function isRangeControl(control){return control.type===CONTROL_TYPES.RANGE}class input_control_vis_InputControlVis extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);this.handleSubmit=this.handleSubmit.bind(this);this.handleReset=this.handleReset.bind(this);this.handleClearAll=this.handleClearAll.bind(this)}handleSubmit(){this.props.submitFilters()}handleReset(){this.props.resetControls()}handleClearAll(){this.props.clearControls()}renderControls(){return this.props.controls.map((control,index)=>{let controlComponent=null;if(isListControl(control)){controlComponent=external_osdSharedDeps_React_default.a.createElement(list_control_ListControl,{id:control.id,label:control.label,options:control.selectOptions,selectedOptions:control.value,formatOptionLabel:control.format,disableMsg:control.isEnabled()?undefined:control.disabledReason,multiselect:control.options.multiselect,partialResults:control.partialResults,dynamicOptions:control.options.dynamicOptions,controlIndex:index,stageFilter:this.props.stageFilter,fetchOptions:query=>{this.props.refreshControl(index,query)}})}else if(isRangeControl(control)){controlComponent=external_osdSharedDeps_React_default.a.createElement(range_control_RangeControl,{control:control,controlIndex:index,stageFilter:this.props.stageFilter})}else{throw new Error(`Unhandled control type ${control.type}`)}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{key:control.id,style:{minWidth:"250px"},"data-test-subj":"inputControlItem"},controlComponent)})}renderStagingButtons(){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButton"],{onClick:this.handleSubmit,disabled:!this.props.hasChanges(),"data-test-subj":"inputControlSubmitBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.vis.inputControlVis.applyChangesButtonLabel",defaultMessage:"Apply changes"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButtonEmpty"],{onClick:this.handleReset,disabled:!this.props.hasChanges(),"data-test-subj":"inputControlCancelBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.vis.inputControlVis.cancelChangesButtonLabel",defaultMessage:"Cancel changes"}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButtonEmpty"],{onClick:this.handleClearAll,disabled:!this.props.hasValues(),"data-test-subj":"inputControlClearBtn"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.vis.inputControlVis.clearFormButtonLabel",defaultMessage:"Clear form"}))))}render(){let stagingButtons;if(this.props.controls.length>0&&!this.props.updateFiltersOnChange){stagingButtons=this.renderStagingButtons()}return external_osdSharedDeps_React_default.a.createElement("div",{className:"icvContainer"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],{wrap:true},this.renderControls()),stagingButtons)}}function control_defineProperty(obj,key,value){key=control_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function control_toPropertyKey(arg){var key=control_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function control_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function noValuesDisableMsg(fieldName,indexPatternName){return external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.control.noValuesDisableTooltip",{defaultMessage:'Filtering occurs on the "{fieldName}" field, which doesn\'t exist on any documents in the "{indexPatternName}" index pattern. Choose a different field or index documents that contain values for this field.',values:{fieldName:fieldName,indexPatternName:indexPatternName}})}function noIndexPatternMsg(indexPatternId){return external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.control.noIndexPatternTooltip",{defaultMessage:"Could not locate index-pattern id: {indexPatternId}.",values:{indexPatternId:indexPatternId}})}class control_Control{constructor(controlParams,filterManager,useTimeFilter){this.controlParams=controlParams;this.filterManager=filterManager;this.useTimeFilter=useTimeFilter;control_defineProperty(this,"osdFilter",null);control_defineProperty(this,"enable",false);control_defineProperty(this,"disabledReason","");control_defineProperty(this,"value",void 0);control_defineProperty(this,"id",void 0);control_defineProperty(this,"options",void 0);control_defineProperty(this,"type",void 0);control_defineProperty(this,"label",void 0);control_defineProperty(this,"ancestors",[]);control_defineProperty(this,"format",value=>{const indexPattern=this.filterManager.getIndexPattern();const field=this.filterManager.getField();if(field){return indexPattern.getFormatterForField(field).convert(value)}return value});this.id=controlParams.id;this.controlParams=controlParams;this.options=controlParams.options;this.type=controlParams.type;this.label=controlParams.label?controlParams.label:controlParams.fieldName;this.reset();this.disable(external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.control.notInitializedTooltip",{defaultMessage:"Control has not been initialized"}))}setAncestors(ancestors){this.ancestors=ancestors}hasAncestors(){return this.ancestors&&this.ancestors.length>0}hasUnsetAncestor(){return this.ancestors.reduce((accumulator,ancestor)=>accumulator||!ancestor.hasValue(),false)}getAncestorValues(){return this.ancestors.map(ancestor=>ancestor.value)}getAncestorFilters(){return this.ancestors.map(ancestor=>ancestor.filterManager.createFilter(ancestor.value))}isEnabled(){return this.enable}disable(reason){this.enable=false;this.disabledReason=reason}set(newValue){this.value=newValue;if(this.hasValue()){this.osdFilter=this.filterManager.createFilter(this.value)}else{this.osdFilter=null}}reset(){this.osdFilter=null;this.value=this.filterManager.getValueFromFilterBar()}clear(){this.value=undefined}hasChanged(){return!external_osdSharedDeps_Lodash_default.a.isEqual(this.value,this.filterManager.getValueFromFilterBar())}hasOsdFilter(){if(this.osdFilter){return true}return false}getOsdFilter(){return this.osdFilter}hasValue(){return this.value!==undefined}}class filter_manager_FilterManager{constructor(controlId,fieldName,indexPattern,queryFilter){this.controlId=controlId;this.fieldName=fieldName;this.indexPattern=indexPattern;this.queryFilter=queryFilter}getIndexPattern(){return this.indexPattern}getField(){return this.indexPattern.fields.getByName(this.fieldName)}findFilters(){const osdFilters=external_osdSharedDeps_Lodash_default.a.flatten([this.queryFilter.getAppFilters(),this.queryFilter.getGlobalFilters()]);return osdFilters.filter(osdFilter=>external_osdSharedDeps_Lodash_default.a.get(osdFilter,"meta.controlledBy")===this.controlId)}}var data_public_=__webpack_require__(6);function toRange(sliderValue){return{gte:sliderValue.min,lte:sliderValue.max}}function fromRange(range){const sliderValue={};if(external_osdSharedDeps_Lodash_default.a.has(range,"gte")){sliderValue.min=external_osdSharedDeps_Lodash_default.a.get(range,"gte")}if(external_osdSharedDeps_Lodash_default.a.has(range,"gt")){sliderValue.min=external_osdSharedDeps_Lodash_default.a.get(range,"gt")}if(external_osdSharedDeps_Lodash_default.a.has(range,"lte")){sliderValue.max=external_osdSharedDeps_Lodash_default.a.get(range,"lte")}if(external_osdSharedDeps_Lodash_default.a.has(range,"lt")){sliderValue.max=external_osdSharedDeps_Lodash_default.a.get(range,"lt")}return sliderValue}class range_filter_manager_RangeFilterManager extends filter_manager_FilterManager{createFilter(value){const newFilter=data_public_["opensearchFilters"].buildRangeFilter(this.indexPattern.fields.getByName(this.fieldName),toRange(value),this.indexPattern);newFilter.meta.key=this.fieldName;newFilter.meta.controlledBy=this.controlId;return newFilter}getValueFromFilterBar(){const osdFilters=this.findFilters();if(osdFilters.length===0){return}let range;if(external_osdSharedDeps_Lodash_default.a.has(osdFilters[0],"script")){range=external_osdSharedDeps_Lodash_default.a.get(osdFilters[0],"script.script.params")}else{range=external_osdSharedDeps_Lodash_default.a.get(osdFilters[0],["range",this.fieldName])}if(!range){return}return fromRange(range)}}async function createSearchSource(_ref,initialState,indexPattern,aggs,useTimeFilter){let{create:create}=_ref;let filters=arguments.length>5&&arguments[5]!==undefined?arguments[5]:[];let timefilter=arguments.length>6?arguments[6]:undefined;const searchSource=await create(initialState||{});searchSource.setParent(undefined);searchSource.setField("filter",()=>{const activeFilters=[...filters];if(useTimeFilter){const filter=timefilter.createFilter(indexPattern);if(filter){activeFilters.push(filter)}}return activeFilters});searchSource.setField("size",0);searchSource.setField("index",indexPattern);searchSource.setField("aggs",aggs);return searchSource}function range_control_factory_defineProperty(obj,key,value){key=range_control_factory_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function range_control_factory_toPropertyKey(arg){var key=range_control_factory_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function range_control_factory_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}const minMaxAgg=field=>{const aggBody={};if(field){if(field.scripted){aggBody.script={source:field.script,lang:field.lang}}else{aggBody.field=field.name}}return{maxAgg:{max:aggBody},minAgg:{min:aggBody}}};class range_control_factory_RangeControl extends control_Control{constructor(controlParams,filterManager,useTimeFilter,searchSource,deps){super(controlParams,filterManager,useTimeFilter);range_control_factory_defineProperty(this,"searchSource",void 0);range_control_factory_defineProperty(this,"timefilter",void 0);range_control_factory_defineProperty(this,"abortController",void 0);range_control_factory_defineProperty(this,"min",void 0);range_control_factory_defineProperty(this,"max",void 0);this.timefilter=deps.data.query.timefilter.timefilter;this.searchSource=searchSource}async fetch(){if(this.abortController){this.abortController.abort()}this.abortController=new AbortController;const indexPattern=this.filterManager.getIndexPattern();if(!indexPattern){this.disable(noIndexPatternMsg(this.controlParams.indexPattern));return}const fieldName=this.filterManager.fieldName;const aggs=minMaxAgg(indexPattern.fields.getByName(fieldName));const searchSource=await createSearchSource(this.searchSource,null,indexPattern,aggs,this.useTimeFilter,[],this.timefilter);const abortSignal=this.abortController.signal;let resp;try{resp=await searchSource.fetch({abortSignal:abortSignal})}catch(error){if(error.name==="AbortError")return;this.disable(external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.rangeControl.unableToFetchTooltip",{defaultMessage:"Unable to fetch range min and max, error: {errorMessage}",values:{errorMessage:error.message}}));return}const min=external_osdSharedDeps_Lodash_default.a.get(resp,"aggregations.minAgg.value",null);const max=external_osdSharedDeps_Lodash_default.a.get(resp,"aggregations.maxAgg.value",null);if(min===null||max===null){this.disable(noValuesDisableMsg(fieldName,indexPattern.title));return}this.min=min;this.max=max;this.enable=true}destroy(){if(this.abortController)this.abortController.abort()}}async function rangeControlFactory(controlParams,useTimeFilter,deps){const[,{data:dataPluginStart}]=await deps.core.getStartServices();const indexPattern=await dataPluginStart.indexPatterns.get(controlParams.indexPattern);return new range_control_factory_RangeControl(controlParams,new range_filter_manager_RangeFilterManager(controlParams.id,controlParams.fieldName,indexPattern,deps.data.query.filterManager),useTimeFilter,dataPluginStart.search.searchSource,deps)}class phrase_filter_manager_PhraseFilterManager extends filter_manager_FilterManager{constructor(controlId,fieldName,indexPattern,queryFilter){super(controlId,fieldName,indexPattern,queryFilter)}createFilter(phrases){let newFilter;const value=this.indexPattern.fields.getByName(this.fieldName);if(!value){throw new Error(`Unable to find field with name: ${this.fieldName} on indexPattern`)}if(phrases.length===1){newFilter=data_public_["opensearchFilters"].buildPhraseFilter(value,phrases[0],this.indexPattern)}else{newFilter=data_public_["opensearchFilters"].buildPhrasesFilter(value,phrases,this.indexPattern)}newFilter.meta.key=this.fieldName;newFilter.meta.controlledBy=this.controlId;return newFilter}getValueFromFilterBar(){const osdFilters=this.findFilters();if(osdFilters.length===0){return}const values=osdFilters.map(osdFilter=>this.getValueFromFilter(osdFilter)).filter(value=>value!=null);if(values.length===0){return}return values.reduce((accumulator,currentValue)=>accumulator.concat(currentValue),[])}getValueFromFilter(osdFilter){if(external_osdSharedDeps_Lodash_default.a.has(osdFilter,"query.bool.should")){return external_osdSharedDeps_Lodash_default.a.get(osdFilter,"query.bool.should").map(osdQueryFilter=>this.getValueFromFilter(osdQueryFilter)).filter(value=>{if(value){return true}return false})}if(external_osdSharedDeps_Lodash_default.a.has(osdFilter,"script")){return external_osdSharedDeps_Lodash_default.a.get(osdFilter,"script.script.params.value")}if(data_public_["opensearchFilters"].isPhraseFilter(osdFilter)){if(data_public_["opensearchFilters"].getPhraseFilterField(osdFilter)!==this.fieldName){return}return data_public_["opensearchFilters"].getPhraseFilterValue(osdFilter)}if(external_osdSharedDeps_Lodash_default.a.has(osdFilter,["match_phrase",this.fieldName])){return external_osdSharedDeps_Lodash_default.a.get(osdFilter,["match_phrase",this.fieldName])}}}function list_control_factory_defineProperty(obj,key,value){key=list_control_factory_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function list_control_factory_toPropertyKey(arg){var key=list_control_factory_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function list_control_factory_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function getEscapedQuery(){let query=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";return query.replace(/[.?+*|{}[\]()"\\#@&<>~]/g,match=>`\\${match}`)}const termsAgg=_ref=>{let{field:field,size:size,direction:direction,query:query}=_ref;const terms={order:{_count:direction}};if(size){terms.size=size<1?1:size}if(field!==null&&field!==void 0&&field.scripted){terms.script={source:field.script,lang:field.lang};terms.value_type=field.type==="number"?"float":field.type}else{terms.field=field===null||field===void 0?void 0:field.name}if(query){terms.include=`.*${getEscapedQuery(query)}.*`}return{termsAgg:{terms:terms}}};class list_control_factory_ListControl extends control_Control{constructor(controlParams,filterManager,useTimeFilter,_searchSource,deps){super(controlParams,filterManager,useTimeFilter);list_control_factory_defineProperty(this,"getSettings",void 0);list_control_factory_defineProperty(this,"timefilter",void 0);list_control_factory_defineProperty(this,"searchSource",void 0);list_control_factory_defineProperty(this,"abortController",void 0);list_control_factory_defineProperty(this,"lastAncestorValues",void 0);list_control_factory_defineProperty(this,"lastQuery",void 0);list_control_factory_defineProperty(this,"partialResults",void 0);list_control_factory_defineProperty(this,"selectOptions",void 0);list_control_factory_defineProperty(this,"fetch",async query=>{if(this.abortController){this.abortController.abort()}this.abortController=new AbortController;const indexPattern=this.filterManager.getIndexPattern();if(!indexPattern){this.disable(noIndexPatternMsg(this.controlParams.indexPattern));return}let ancestorFilters;if(this.hasAncestors()){if(this.hasUnsetAncestor()){this.disable(external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.listControl.disableTooltip",{defaultMessage:"Disabled until '{label}' is set.",values:{label:this.ancestors[0].label}}));this.lastAncestorValues=undefined;return}const ancestorValues=this.getAncestorValues();if(external_osdSharedDeps_Lodash_default.a.isEqual(ancestorValues,this.lastAncestorValues)&&external_osdSharedDeps_Lodash_default.a.isEqual(query,this.lastQuery)){return}this.lastAncestorValues=ancestorValues;this.lastQuery=query;ancestorFilters=this.getAncestorFilters()}const fieldName=this.filterManager.fieldName;const settings=await this.getSettings();const initialSearchSourceState={timeout:`${settings.autocompleteTimeout}ms`,terminate_after:Number(settings.autocompleteTerminateAfter)};const aggs=termsAgg({field:indexPattern.fields.getByName(fieldName),size:this.options.dynamicOptions?null:external_osdSharedDeps_Lodash_default.a.get(this.options,"size",5),direction:"desc",query:query});const searchSource=await createSearchSource(this.searchSource,initialSearchSourceState,indexPattern,aggs,this.useTimeFilter,ancestorFilters,this.timefilter);const abortSignal=this.abortController.signal;this.lastQuery=query;let resp;try{resp=await searchSource.fetch({abortSignal:abortSignal})}catch(error){if(error.name==="AbortError")return;this.disable(external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.listControl.unableToFetchTooltip",{defaultMessage:"Unable to fetch terms, error: {errorMessage}",values:{errorMessage:error.message}}));return}if(query&&this.lastQuery!==query){return}const selectOptions=external_osdSharedDeps_Lodash_default.a.get(resp,"aggregations.termsAgg.buckets",[]).map(bucket=>bucket===null||bucket===void 0?void 0:bucket.key);if(selectOptions.length===0&&!query){this.disable(noValuesDisableMsg(fieldName,indexPattern.title));return}this.partialResults=resp.terminated_early||resp.timed_out;this.selectOptions=selectOptions;this.enable=true;this.disabledReason=""});this.getSettings=deps.getSettings;this.timefilter=deps.data.query.timefilter.timefilter;this.searchSource=_searchSource}destroy(){if(this.abortController)this.abortController.abort()}hasValue(){return typeof this.value!=="undefined"&&this.value.length>0}}async function listControlFactory(controlParams,useTimeFilter,deps){const[,{data:dataPluginStart}]=await deps.core.getStartServices();const indexPattern=await dataPluginStart.indexPatterns.get(controlParams.indexPattern);const field=indexPattern.fields.getAll().find(_ref2=>{let{name:name}=_ref2;return name===controlParams.fieldName});if(field&&field.type!=="string"){controlParams.options.dynamicOptions=false}const listControl=new list_control_factory_ListControl(controlParams,new phrase_filter_manager_PhraseFilterManager(controlParams.id,controlParams.fieldName,indexPattern,deps.data.query.filterManager),useTimeFilter,dataPluginStart.search.searchSource,deps);return listControl}function getControlFactory(controlParams){let factory=null;switch(controlParams.type){case CONTROL_TYPES.RANGE:factory=rangeControlFactory;break;case CONTROL_TYPES.LIST:factory=listControlFactory;break;default:throw new Error(`Unhandled control type ${controlParams.type}`)}return factory}function getLineageMap(controlParamsList){function getControlParamsById(controlId){return controlParamsList.find(controlParams=>controlParams.id===controlId)}const lineageMap=new Map;controlParamsList.forEach(rootControlParams=>{const lineage=[rootControlParams.id];const getLineage=controlParams=>{if(external_osdSharedDeps_Lodash_default.a.has(controlParams,"parent")&&controlParams.parent!==""&&!lineage.includes(controlParams.parent)){lineage.push(controlParams.parent);const parent=getControlParamsById(controlParams.parent);if(parent){getLineage(parent)}}};getLineage(rootControlParams);lineageMap.set(rootControlParams.id,lineage)});return lineageMap}function getParentCandidates(controlParamsList,controlId,lineageMap){return controlParamsList.filter(controlParams=>{if(!controlParams.indexPattern||!controlParams.fieldName){return false}const lineage=lineageMap.get(controlParams.id);if(lineage!==null&&lineage!==void 0&&lineage.includes(controlId)){return false}return true}).map((controlParams,controlIndex)=>({value:controlParams.id,text:getTitle(controlParams,controlIndex)}))}function vis_controller_defineProperty(obj,key,value){key=vis_controller_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function vis_controller_toPropertyKey(arg){var key=vis_controller_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function vis_controller_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}const createInputControlVisController=deps=>class InputControlVisController{constructor(el,vis){this.el=el;this.vis=vis;vis_controller_defineProperty(this,"I18nContext",void 0);vis_controller_defineProperty(this,"_isLoaded",false);vis_controller_defineProperty(this,"controls",void 0);vis_controller_defineProperty(this,"queryBarUpdateHandler",void 0);vis_controller_defineProperty(this,"filterManager",void 0);vis_controller_defineProperty(this,"updateSubsciption",void 0);vis_controller_defineProperty(this,"timeFilterSubscription",void 0);vis_controller_defineProperty(this,"visParams",void 0);vis_controller_defineProperty(this,"drawVis",()=>{var _this$visParams;if(!this.I18nContext){throw new Error("no i18n context found")}Object(external_osdSharedDeps_ReactDom_["render"])(external_osdSharedDeps_React_default.a.createElement(this.I18nContext,null,external_osdSharedDeps_React_default.a.createElement(input_control_vis_InputControlVis,{updateFiltersOnChange:(_this$visParams=this.visParams)===null||_this$visParams===void 0?void 0:_this$visParams.updateFiltersOnChange,controls:this.controls,stageFilter:this.stageFilter,submitFilters:this.submitFilters,resetControls:this.updateControlsFromOsd,clearControls:this.clearControls,hasChanges:this.hasChanges,hasValues:this.hasValues,refreshControl:this.refreshControl})),this.el)});vis_controller_defineProperty(this,"stageFilter",async(controlIndex,newValue)=>{var _this$visParams2;this.controls[controlIndex].set(newValue);if((_this$visParams2=this.visParams)!==null&&_this$visParams2!==void 0&&_this$visParams2.updateFiltersOnChange){this.submitFilters()}else{await this.updateNestedControls();this.drawVis()}});vis_controller_defineProperty(this,"submitFilters",()=>{var _this$visParams3;const stagedControls=this.controls.filter(control=>control.hasChanged());const newFilters=stagedControls.map(control=>control.getOsdFilter()).filter(filter=>filter!==null);stagedControls.forEach(control=>{control.filterManager.findFilters().forEach(existingFilter=>{this.filterManager.removeFilter(existingFilter)})});this.controls.map(control=>{if(control.hasAncestors()&&control.hasUnsetAncestor()){control.filterManager.findFilters().forEach(existingFilter=>{this.filterManager.removeFilter(existingFilter)})}});this.filterManager.addFilters(newFilters,(_this$visParams3=this.visParams)===null||_this$visParams3===void 0?void 0:_this$visParams3.pinFilters)});vis_controller_defineProperty(this,"clearControls",async()=>{this.controls.forEach(control=>{control.clear()});await this.updateNestedControls();this.drawVis()});vis_controller_defineProperty(this,"updateControlsFromOsd",async()=>{this.controls.forEach(control=>{control.reset()});await this.updateNestedControls();this.drawVis()});vis_controller_defineProperty(this,"hasChanges",()=>this.controls.map(control=>control.hasChanged()).some(control=>control));vis_controller_defineProperty(this,"hasValues",()=>this.controls.map(control=>control.hasValue()).reduce((a,b)=>a||b));vis_controller_defineProperty(this,"refreshControl",async(controlIndex,query)=>{await this.controls[controlIndex].fetch(query);this.drawVis()});this.controls=[];this.queryBarUpdateHandler=this.updateControlsFromOsd.bind(this);this.filterManager=deps.data.query.filterManager;this.updateSubsciption=this.filterManager.getUpdates$().subscribe(this.queryBarUpdateHandler);this.timeFilterSubscription=deps.data.query.timefilter.timefilter.getTimeUpdate$().subscribe(()=>{var _this$visParams4;if((_this$visParams4=this.visParams)!==null&&_this$visParams4!==void 0&&_this$visParams4.useTimeFilter){this._isLoaded=false}})}async render(visData,visParams){if(!this.I18nContext){const[{i18n:i18n}]=await deps.core.getStartServices();this.I18nContext=i18n.Context}if(!this._isLoaded||!Object(external_osdSharedDeps_Lodash_["isEqual"])(visParams,this.visParams)){this.visParams=visParams;this.controls=[];this.controls=await this.initControls();this._isLoaded=true}this.drawVis()}destroy(){this.updateSubsciption.unsubscribe();this.timeFilterSubscription.unsubscribe();Object(external_osdSharedDeps_ReactDom_["unmountComponentAtNode"])(this.el);this.controls.forEach(control=>control.destroy())}async initControls(){var _this$visParams5;const controlParamsList=(_this$visParams5=this.visParams)===null||_this$visParams5===void 0||(_this$visParams5=_this$visParams5.controls)===null||_this$visParams5===void 0?void 0:_this$visParams5.filter(controlParams=>controlParams.indexPattern&&controlParams.fieldName);const controlFactoryPromises=controlParamsList.map(controlParams=>{var _this$visParams6;const factory=getControlFactory(controlParams);return factory(controlParams,(_this$visParams6=this.visParams)===null||_this$visParams6===void 0?void 0:_this$visParams6.useTimeFilter,deps)});const controls=await Promise.all(controlFactoryPromises);const getControl=controlId=>controls.find(_ref=>{let{id:id}=_ref;return id===controlId});const controlInitPromises=[];getLineageMap(controlParamsList).forEach((lineage,controlId)=>{lineage.shift();const ancestors=[];lineage.forEach(ancestorId=>{const control=getControl(ancestorId);if(control){ancestors.push(control)}});const control=getControl(controlId);if(control){control.setAncestors(ancestors);controlInitPromises.push(control.fetch())}});await Promise.all(controlInitPromises);return controls}async updateNestedControls(){const fetchPromises=this.controls.map(async control=>{if(control.hasAncestors()){await control.fetch()}});return await Promise.all(fetchPromises)}};function IndexPatternSelectFormRowUi(props){const{controlIndex:controlIndex,indexPatternId:indexPatternId,intl:intl,onChange:onChange}=props;const selectId=`indexPatternSelect-${controlIndex}`;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:selectId,label:intl.formatMessage({id:"inputControl.editor.indexPatternSelect.patternLabel",defaultMessage:"Index Pattern"})},external_osdSharedDeps_React_default.a.createElement(props.IndexPatternSelect,{placeholder:intl.formatMessage({id:"inputControl.editor.indexPatternSelect.patternPlaceholder",defaultMessage:"Select index pattern..."}),indexPatternId:indexPatternId,onChange:onChange,"data-test-subj":selectId,savedObjectsClient:{}}))}const IndexPatternSelectFormRow=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(IndexPatternSelectFormRowUi);function field_select_defineProperty(obj,key,value){key=field_select_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function field_select_toPropertyKey(arg){var key=field_select_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function field_select_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class field_select_FieldSelectUi extends external_osdSharedDeps_React_["Component"]{constructor(props){super(props);field_select_defineProperty(this,"hasUnmounted",void 0);field_select_defineProperty(this,"loadFields",indexPatternId=>{this.setState({isLoading:true,fields:[],indexPatternId:indexPatternId},this.debouncedLoad.bind(null,indexPatternId))});field_select_defineProperty(this,"debouncedLoad",external_osdSharedDeps_Lodash_default.a.debounce(async indexPatternId=>{var _this$props$filterFie;if(!indexPatternId||indexPatternId.length===0){return}let indexPattern;try{indexPattern=await this.props.getIndexPattern(indexPatternId)}catch(err){return}if(this.hasUnmounted){return}if(indexPattern.id!==this.state.indexPatternId){return}const fieldsByTypeMap=new Map;const fields=[];indexPattern.fields.filter((_this$props$filterFie=this.props.filterField)!==null&&_this$props$filterFie!==void 0?_this$props$filterFie:()=>true).forEach(field=>{var _fieldsByTypeMap$get;const fieldsList=(_fieldsByTypeMap$get=fieldsByTypeMap.get(field.type))!==null&&_fieldsByTypeMap$get!==void 0?_fieldsByTypeMap$get:[];fieldsList.push(field.name);fieldsByTypeMap.set(field.type,fieldsList)});fieldsByTypeMap.forEach((fieldsList,fieldType)=>{fields.push({label:fieldType,options:fieldsList.sort().map(fieldName=>({value:fieldName,label:fieldName}))})});fields.sort((a,b)=>{if(a.label<b.label)return-1;if(a.label>b.label)return 1;return 0});this.setState({isLoading:false,fields:fields})},300));field_select_defineProperty(this,"onChange",selectedOptions=>{this.props.onChange(external_osdSharedDeps_Lodash_default.a.get(selectedOptions,"0.value"))});this.hasUnmounted=false;this.state={isLoading:false,fields:[],indexPatternId:props.indexPatternId}}componentWillUnmount(){this.hasUnmounted=true}componentDidMount(){this.loadFields(this.state.indexPatternId)}UNSAFE_componentWillReceiveProps(nextProps){if(this.props.indexPatternId!==nextProps.indexPatternId){var _nextProps$indexPatte;this.loadFields((_nextProps$indexPatte=nextProps.indexPatternId)!==null&&_nextProps$indexPatte!==void 0?_nextProps$indexPatte:"")}}render(){if(!this.props.indexPatternId||this.props.indexPatternId.trim().length===0){return null}const selectId=`fieldSelect-${this.props.controlIndex}`;const selectedOptions=[];const{intl:intl}=this.props;if(this.props.fieldName){selectedOptions.push({value:this.props.fieldName,label:this.props.fieldName})}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:selectId,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.fieldSelect.fieldLabel",defaultMessage:"Field"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedComboBox"],{placeholder:intl.formatMessage({id:"inputControl.editor.fieldSelect.selectFieldPlaceholder",defaultMessage:"Select field..."}),singleSelection:true,isLoading:this.state.isLoading,options:this.state.fields,selectedOptions:selectedOptions,onChange:this.onChange,"data-test-subj":selectId}))}}const FieldSelect=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(field_select_FieldSelectUi);function range_control_editor_defineProperty(obj,key,value){key=range_control_editor_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function range_control_editor_toPropertyKey(arg){var key=range_control_editor_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function range_control_editor_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function filterField(field){return field.type==="number"}class range_control_editor_RangeControlEditor extends external_osdSharedDeps_React_["Component"]{constructor(){super(...arguments);range_control_editor_defineProperty(this,"state",{IndexPatternSelect:null})}componentDidMount(){this.getIndexPatternSelect()}async getIndexPatternSelect(){const[,{data:data}]=await this.props.deps.core.getStartServices();this.setState({IndexPatternSelect:data.ui.IndexPatternSelect})}render(){const stepSizeId=`stepSize-${this.props.controlIndex}`;const decimalPlacesId=`decimalPlaces-${this.props.controlIndex}`;if(this.state.IndexPatternSelect===null){return null}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_["Fragment"],null,external_osdSharedDeps_React_default.a.createElement(IndexPatternSelectFormRow,{indexPatternId:this.props.controlParams.indexPattern,onChange:this.props.handleIndexPatternChange,controlIndex:this.props.controlIndex,IndexPatternSelect:this.state.IndexPatternSelect}),external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fieldName:this.props.controlParams.fieldName,indexPatternId:this.props.controlParams.indexPattern,filterField:filterField,onChange:this.props.handleFieldNameChange,getIndexPattern:this.props.getIndexPattern,controlIndex:this.props.controlIndex}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:stepSizeId,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.rangeControl.stepSizeLabel",defaultMessage:"Step Size"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFieldNumber"],{value:this.props.controlParams.options.step,onChange:event=>{this.props.handleOptionsChange(this.props.controlIndex,"step",event.target.valueAsNumber)},"data-test-subj":`rangeControlSizeInput${this.props.controlIndex}`})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:decimalPlacesId,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.rangeControl.decimalPlacesLabel",defaultMessage:"Decimal Places"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFieldNumber"],{min:0,value:this.props.controlParams.options.decimalPlaces,onChange:event=>{this.props.handleOptionsChange(this.props.controlIndex,"decimalPlaces",event.target.valueAsNumber)},"data-test-subj":`rangeControlDecimalPlacesInput${this.props.controlIndex}`})))}}function list_control_editor_defineProperty(obj,key,value){key=list_control_editor_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function list_control_editor_toPropertyKey(arg){var key=list_control_editor_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function list_control_editor_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}function list_control_editor_filterField(field){return Boolean(field.aggregatable)&&["number","boolean","date","ip","string"].includes(field.type)}class list_control_editor_ListControlEditor extends external_osdSharedDeps_React_["PureComponent"]{constructor(){super(...arguments);list_control_editor_defineProperty(this,"isMounted",false);list_control_editor_defineProperty(this,"state",{isLoadingFieldType:true,isStringField:false,prevFieldName:this.props.controlParams.fieldName,IndexPatternSelect:null});list_control_editor_defineProperty(this,"componentDidUpdate",()=>{if(this.state.isLoadingFieldType){this.loadIsStringField()}});list_control_editor_defineProperty(this,"loadIsStringField",async()=>{if(!this.props.controlParams.indexPattern||!this.props.controlParams.fieldName){this.setState({isLoadingFieldType:false});return}let indexPattern;try{indexPattern=await this.props.getIndexPattern(this.props.controlParams.indexPattern)}catch(err){return}if(!this.isMounted){return}const field=indexPattern.fields.find(_ref=>{let{name:name}=_ref;return name===this.props.controlParams.fieldName});if(!field){return}this.setState({isLoadingFieldType:false,isStringField:field.type==="string"})});list_control_editor_defineProperty(this,"renderOptions",()=>{var _this$props$controlPa,_this$props$controlPa2;if(this.state.isLoadingFieldType||!this.props.controlParams.fieldName){return}const options=[];if(this.props.parentCandidates&&this.props.parentCandidates.length>0){const parentCandidatesOptions=[{value:"",text:""},...this.props.parentCandidates];options.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:`parentSelect-${this.props.controlIndex}`,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.parentLabel",defaultMessage:"Parent control"}),helpText:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.parentDescription",defaultMessage:"Options are based on the value of parent control. Disabled if parent is not set."}),key:"parentSelect"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSelect"],{options:parentCandidatesOptions,value:this.props.controlParams.parent,onChange:event=>{this.props.handleParentChange(this.props.controlIndex,event.target.value)}})))}options.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:`multiselect-${this.props.controlIndex}`,key:"multiselect",helpText:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.multiselectDescription",defaultMessage:"Allow multiple selection"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSwitch"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.multiselectLabel",defaultMessage:"Multiselect"}),checked:(_this$props$controlPa=this.props.controlParams.options.multiselect)!==null&&_this$props$controlPa!==void 0?_this$props$controlPa:true,onChange:event=>{this.props.handleOptionsChange(this.props.controlIndex,"multiselect",event.target.checked)},"data-test-subj":"listControlMultiselectInput"})));const dynamicOptionsHelpText=this.state.isStringField?external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.dynamicOptions.updateDescription",defaultMessage:"Update options in response to user input"}):external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.dynamicOptions.stringFieldDescription",defaultMessage:'Only available for "string" fields'});options.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:`dynamicOptions-${this.props.controlIndex}`,key:"dynamicOptions",helpText:dynamicOptionsHelpText},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSwitch"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.dynamicOptionsLabel",defaultMessage:"Dynamic Options"}),checked:(_this$props$controlPa2=this.props.controlParams.options.dynamicOptions)!==null&&_this$props$controlPa2!==void 0?_this$props$controlPa2:false,onChange:event=>{this.props.handleOptionsChange(this.props.controlIndex,"dynamicOptions",event.target.checked)},disabled:this.state.isStringField?false:true,"data-test-subj":"listControlDynamicOptionsSwitch"})));if(!this.props.controlParams.options.dynamicOptions||!this.state.isStringField){options.push(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:`size-${this.props.controlIndex}`,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.sizeLabel",defaultMessage:"Size"}),key:"size",helpText:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.listControl.sizeDescription",defaultMessage:"Number of options"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFieldNumber"],{min:1,value:this.props.controlParams.options.size,onChange:event=>{this.props.handleOptionsChange(this.props.controlIndex,"size",event.target.valueAsNumber)},"data-test-subj":"listControlSizeInput"})))}return options})}componentDidMount(){this.isMounted=true;this.loadIsStringField();this.getIndexPatternSelect()}componentWillUnmount(){this.isMounted=false}async getIndexPatternSelect(){const[,{data:data}]=await this.props.deps.core.getStartServices();this.setState({IndexPatternSelect:data.ui.IndexPatternSelect})}render(){if(this.state.IndexPatternSelect===null){return null}return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_React_default.a.Fragment,null,external_osdSharedDeps_React_default.a.createElement(IndexPatternSelectFormRow,{indexPatternId:this.props.controlParams.indexPattern,onChange:this.props.handleIndexPatternChange,controlIndex:this.props.controlIndex,IndexPatternSelect:this.state.IndexPatternSelect}),external_osdSharedDeps_React_default.a.createElement(FieldSelect,{fieldName:this.props.controlParams.fieldName,indexPatternId:this.props.controlParams.indexPattern,filterField:list_control_editor_filterField,onChange:this.props.handleFieldNameChange,getIndexPattern:this.props.getIndexPattern,controlIndex:this.props.controlIndex}),this.renderOptions())}}list_control_editor_defineProperty(list_control_editor_ListControlEditor,"getDerivedStateFromProps",(nextProps,prevState)=>{const isNewFieldName=prevState.prevFieldName!==nextProps.controlParams.fieldName;if(!prevState.isLoadingFieldType&&isNewFieldName){return{prevFieldName:nextProps.controlParams.fieldName,isLoadingFieldType:true}}return null});function control_editor_defineProperty(obj,key,value){key=control_editor_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function control_editor_toPropertyKey(arg){var key=control_editor_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function control_editor_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class control_editor_ControlEditorUi extends external_osdSharedDeps_React_["PureComponent"]{constructor(){super(...arguments);control_editor_defineProperty(this,"changeLabel",event=>{this.props.handleLabelChange(this.props.controlIndex,event.target.value)});control_editor_defineProperty(this,"removeControl",()=>{this.props.handleRemoveControl(this.props.controlIndex)});control_editor_defineProperty(this,"moveUpControl",()=>{this.props.moveControl(this.props.controlIndex,-1)});control_editor_defineProperty(this,"moveDownControl",()=>{this.props.moveControl(this.props.controlIndex,1)});control_editor_defineProperty(this,"changeIndexPattern",indexPatternId=>{this.props.handleIndexPatternChange(this.props.controlIndex,indexPatternId)});control_editor_defineProperty(this,"changeFieldName",fieldName=>{this.props.handleFieldNameChange(this.props.controlIndex,fieldName)})}renderEditor(){let controlEditor=null;switch(this.props.controlParams.type){case CONTROL_TYPES.LIST:controlEditor=external_osdSharedDeps_React_default.a.createElement(list_control_editor_ListControlEditor,{controlIndex:this.props.controlIndex,controlParams:this.props.controlParams,handleIndexPatternChange:this.changeIndexPattern,handleFieldNameChange:this.changeFieldName,getIndexPattern:this.props.getIndexPattern,handleOptionsChange:this.props.handleOptionsChange,parentCandidates:this.props.parentCandidates,handleParentChange:this.props.handleParentChange,deps:this.props.deps});break;case CONTROL_TYPES.RANGE:controlEditor=external_osdSharedDeps_React_default.a.createElement(range_control_editor_RangeControlEditor,{controlIndex:this.props.controlIndex,controlParams:this.props.controlParams,handleIndexPatternChange:this.changeIndexPattern,handleFieldNameChange:this.changeFieldName,getIndexPattern:this.props.getIndexPattern,handleOptionsChange:this.props.handleOptionsChange,deps:this.props.deps});break;default:throw new Error(`Unhandled control editor type ${this.props.controlParams.type}`)}const labelId=`controlLabel${this.props.controlIndex}`;return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiForm"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:labelId,label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.controlEditor.controlLabel",defaultMessage:"Control Label"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFieldText"],{value:this.props.controlParams.label,onChange:this.changeLabel})),controlEditor)}renderEditorButtons(){return external_osdSharedDeps_React_default.a.createElement("div",null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButtonIcon"],{"aria-label":this.props.intl.formatMessage({id:"inputControl.editor.controlEditor.moveControlUpAriaLabel",defaultMessage:"Move control up"}),color:"primary",onClick:this.moveUpControl,iconType:"sortUp","data-test-subj":`inputControlEditorMoveUpControl${this.props.controlIndex}`}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButtonIcon"],{"aria-label":this.props.intl.formatMessage({id:"inputControl.editor.controlEditor.moveControlDownAriaLabel",defaultMessage:"Move control down"}),color:"primary",onClick:this.moveDownControl,iconType:"sortDown","data-test-subj":`inputControlEditorMoveDownControl${this.props.controlIndex}`}),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButtonIcon"],{"aria-label":this.props.intl.formatMessage({id:"inputControl.editor.controlEditor.removeControlAriaLabel",defaultMessage:"Remove control"}),color:"danger",onClick:this.removeControl,iconType:"cross","data-test-subj":`inputControlEditorRemoveControl${this.props.controlIndex}`}))}render(){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],{grow:false,className:"icvControlEditor__panel"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiAccordion"],{id:"controlEditorAccordion",buttonContent:getTitle(this.props.controlParams,this.props.controlIndex),extraAction:this.renderEditorButtons(),initialIsOpen:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),this.renderEditor()))}}const ControlEditor=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(control_editor_ControlEditorUi);function _extends(){_extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function controls_tab_defineProperty(obj,key,value){key=controls_tab_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function controls_tab_toPropertyKey(arg){var key=controls_tab_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function controls_tab_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class controls_tab_ControlsTabUi extends external_osdSharedDeps_React_["PureComponent"]{constructor(){super(...arguments);controls_tab_defineProperty(this,"state",{type:CONTROL_TYPES.LIST});controls_tab_defineProperty(this,"getIndexPattern",async indexPatternId=>{const[,startDeps]=await this.props.deps.core.getStartServices();return await startDeps.data.indexPatterns.get(indexPatternId)});controls_tab_defineProperty(this,"onChange",value=>this.props.setValue("controls",value));controls_tab_defineProperty(this,"handleLabelChange",(controlIndex,label)=>{const updatedControl={...this.props.stateParams.controls[controlIndex],label:label};this.onChange(setControl(this.props.stateParams.controls,controlIndex,updatedControl))});controls_tab_defineProperty(this,"handleIndexPatternChange",(controlIndex,indexPattern)=>{const updatedControl={...this.props.stateParams.controls[controlIndex],indexPattern:indexPattern,fieldName:""};this.onChange(setControl(this.props.stateParams.controls,controlIndex,updatedControl))});controls_tab_defineProperty(this,"handleFieldNameChange",(controlIndex,fieldName)=>{const updatedControl={...this.props.stateParams.controls[controlIndex],fieldName:fieldName};this.onChange(setControl(this.props.stateParams.controls,controlIndex,updatedControl))});controls_tab_defineProperty(this,"handleOptionsChange",(controlIndex,optionName,value)=>{const control=this.props.stateParams.controls[controlIndex];const updatedControl={...control,options:{...control.options,[optionName]:value}};this.onChange(setControl(this.props.stateParams.controls,controlIndex,updatedControl))});controls_tab_defineProperty(this,"handleRemoveControl",controlIndex=>{this.onChange(removeControl(this.props.stateParams.controls,controlIndex))});controls_tab_defineProperty(this,"moveControl",(controlIndex,direction)=>{this.onChange(moveControl(this.props.stateParams.controls,controlIndex,direction))});controls_tab_defineProperty(this,"handleAddControl",()=>{this.onChange(addControl(this.props.stateParams.controls,newControl(this.state.type)))});controls_tab_defineProperty(this,"handleParentChange",(controlIndex,parent)=>{const updatedControl={...this.props.stateParams.controls[controlIndex],parent:parent};this.onChange(setControl(this.props.stateParams.controls,controlIndex,updatedControl))})}renderControls(){const lineageMap=getLineageMap(this.props.stateParams.controls);return this.props.stateParams.controls.map((controlParams,controlIndex)=>{const parentCandidates=getParentCandidates(this.props.stateParams.controls,controlParams.id,lineageMap);return external_osdSharedDeps_React_default.a.createElement(ControlEditor,{key:controlParams.id,controlIndex:controlIndex,controlParams:controlParams,handleLabelChange:this.handleLabelChange,moveControl:this.moveControl,handleRemoveControl:this.handleRemoveControl,handleIndexPatternChange:this.handleIndexPatternChange,handleFieldNameChange:this.handleFieldNameChange,getIndexPattern:this.getIndexPattern,handleOptionsChange:this.handleOptionsChange,parentCandidates:parentCandidates,handleParentChange:this.handleParentChange,deps:this.props.deps})})}render(){const{intl:intl}=this.props;return external_osdSharedDeps_React_default.a.createElement("div",null,this.renderControls(),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPanel"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:"selectControlType"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSelect"],{"data-test-subj":"selectControlType",options:[{value:CONTROL_TYPES.RANGE,text:intl.formatMessage({id:"inputControl.editor.controlsTab.select.rangeDropDownOptionLabel",defaultMessage:"Range slider"})},{value:CONTROL_TYPES.LIST,text:intl.formatMessage({id:"inputControl.editor.controlsTab.select.listDropDownOptionLabel",defaultMessage:"Options list"})}],value:this.state.type,onChange:event=>this.setState({type:event.target.value}),"aria-label":intl.formatMessage({id:"inputControl.editor.controlsTab.select.controlTypeAriaLabel",defaultMessage:"Select control type"})}))),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:"addControl"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiSmallButton"],{onClick:this.handleAddControl,iconType:"plusInCircle","data-test-subj":"inputControlEditorAddBtn","aria-label":intl.formatMessage({id:"inputControl.editor.controlsTab.select.addControlAriaLabel",defaultMessage:"Add control"})},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.controlsTab.addButtonLabel",defaultMessage:"Add"})))))))}}const controls_tab_ControlsTab=Object(external_osdSharedDeps_OsdI18nReact_["injectI18n"])(controls_tab_ControlsTabUi);const getControlsTab=deps=>props=>external_osdSharedDeps_React_default.a.createElement(controls_tab_ControlsTab,_extends({},props,{deps:deps}));function options_tab_defineProperty(obj,key,value){key=options_tab_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function options_tab_toPropertyKey(arg){var key=options_tab_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function options_tab_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class options_tab_OptionsTab extends external_osdSharedDeps_React_["PureComponent"]{constructor(){super(...arguments);options_tab_defineProperty(this,"handleUpdateFiltersChange",event=>{this.props.setValue("updateFiltersOnChange",event.target.checked)});options_tab_defineProperty(this,"handleUseTimeFilter",event=>{this.props.setValue("useTimeFilter",event.target.checked)});options_tab_defineProperty(this,"handlePinFilters",event=>{this.props.setValue("pinFilters",event.target.checked)})}render(){return external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiForm"],null,external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:"updateFiltersOnChange"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSwitch"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.optionsTab.updateFilterLabel",defaultMessage:"Update OpenSearch Dashboards filters on each change"}),checked:this.props.stateParams.updateFiltersOnChange,onChange:this.handleUpdateFiltersChange,"data-test-subj":"inputControlEditorUpdateFiltersOnChangeCheckbox"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:"useTimeFilter"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSwitch"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.optionsTab.useTimeFilterLabel",defaultMessage:"Use time filter"}),checked:this.props.stateParams.useTimeFilter,onChange:this.handleUseTimeFilter,"data-test-subj":"inputControlEditorUseTimeFilterCheckbox"})),external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedFormRow"],{id:"pinFilters"},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiCompressedSwitch"],{label:external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_OsdI18nReact_["FormattedMessage"],{id:"inputControl.editor.optionsTab.pinFiltersLabel",defaultMessage:"Pin filters for all applications"}),checked:this.props.stateParams.pinFilters,onChange:this.handlePinFilters,"data-test-subj":"inputControlEditorPinFiltersCheckbox"})))}}function createInputControlVisTypeDefinition(deps){const InputControlVisController=createInputControlVisController(deps);const ControlsTab=getControlsTab(deps);return{name:"input_control_vis",title:external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.register.controlsTitle",{defaultMessage:"Controls"}),icon:"controlsHorizontal",description:external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.register.controlsDescription",{defaultMessage:"Create interactive controls for easy dashboard manipulation."}),stage:"experimental",visualization:InputControlVisController,visConfig:{defaults:{controls:[],updateFiltersOnChange:false,useTimeFilter:false,pinFilters:false}},editorConfig:{optionTabs:[{name:"controls",title:external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.register.tabs.controlsTitle",{defaultMessage:"Controls"}),editor:ControlsTab},{name:"options",title:external_osdSharedDeps_OsdI18n_["i18n"].translate("inputControl.register.tabs.optionsTitle",{defaultMessage:"Options"}),editor:options_tab_OptionsTab}]},inspectorAdapters:{},requestHandler:"none",responseHandler:"none"}}function plugin_defineProperty(obj,key,value){key=plugin_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function plugin_toPropertyKey(arg){var key=plugin_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function plugin_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class plugin_InputControlVisPlugin{constructor(initializerContext){this.initializerContext=initializerContext;plugin_defineProperty(this,"cachedSettings",undefined)}setup(core,_ref){let{expressions:expressions,visualizations:visualizations,data:data}=_ref;const visualizationDependencies={core:core,data:data,getSettings:async()=>{if(!this.cachedSettings){this.cachedSettings=await core.http.get("/api/input_control_vis/settings")}return this.cachedSettings}};expressions.registerFunction(createInputControlVisFn);visualizations.createBaseVisualization(createInputControlVisTypeDefinition(visualizationDependencies))}start(core,deps){}}function public_plugin(initializerContext){return new plugin_InputControlVisPlugin(initializerContext)}}]);