(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=8)})([function(module,exports){module.exports=__osdSharedDeps__.OsdI18n},function(module,exports){module.exports=__osdSharedDeps__.React},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__osdBundles__.get("plugin/opensearchDashboardsReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__osdSharedDeps__.Lodash},function(module,exports){module.exports=__osdSharedDeps__.ElasticEui},function(module,exports){module.exports=__osdSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__osdBundles__.get("plugin/opensearchDashboardsUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports,__webpack_require__){"use strict";var R=typeof Reflect==="object"?Reflect:null;var ReflectApply=R&&typeof R.apply==="function"?R.apply:function ReflectApply(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};var ReflectOwnKeys;if(R&&typeof R.ownKeys==="function"){ReflectOwnKeys=R.ownKeys}else if(Object.getOwnPropertySymbols){ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}}else{ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target)}}function ProcessEmitWarning(warning){if(console&&console.warn)console.warn(warning)}var NumberIsNaN=Number.isNaN||function NumberIsNaN(value){return value!==value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter;module.exports.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;function checkListener(listener){if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=="number"||arg<0||NumberIsNaN(arg)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".")}defaultMaxListeners=arg}});EventEmitter.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=="number"||n<0||NumberIsNaN(n)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".")}this._maxListeners=n;return this};function _getMaxListeners(that){if(that._maxListeners===undefined)return EventEmitter.defaultMaxListeners;return that._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function emit(type){var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);var doError=type==="error";var events=this._events;if(events!==undefined)doError=doError&&events.error===undefined;else if(!doError)return false;if(doError){var er;if(args.length>0)er=args[0];if(er instanceof Error){throw er}var err=new Error("Unhandled error."+(er?" ("+er.message+")":""));err.context=er;throw err}var handler=events[type];if(handler===undefined)return false;if(typeof handler==="function"){ReflectApply(handler,this,args)}else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)ReflectApply(listeners[i],this,args)}return true};function _addListener(target,type,listener,prepend){var m;var events;var existing;checkListener(listener);events=target._events;if(events===undefined){events=target._events=Object.create(null);target._eventsCount=0}else{if(events.newListener!==undefined){target.emit("newListener",type,listener.listener?listener.listener:listener);events=target._events}existing=events[type]}if(existing===undefined){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==="function"){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else if(prepend){existing.unshift(listener)}else{existing.push(listener)}m=_getMaxListeners(target);if(m>0&&existing.length>m&&!existing.warned){existing.warned=true;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");w.name="MaxListenersExceededWarning";w.emitter=target;w.type=type;w.count=existing.length;ProcessEmitWarning(w)}}return target}EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,true)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function _onceWrap(target,type,listener){var state={fired:false,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=onceWrapper.bind(state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}EventEmitter.prototype.once=function once(type,listener){checkListener(listener);this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){checkListener(listener);this.prependListener(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;checkListener(listener);events=this._events;if(events===undefined)return this;list=events[type];if(list===undefined)return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)this._events=Object.create(null);else{delete events[type];if(events.removeListener)this.emit("removeListener",type,list.listener||listener)}}else if(typeof list!=="function"){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}if(position<0)return this;if(position===0)list.shift();else{spliceOne(list,position)}if(list.length===1)events[type]=list[0];if(events.removeListener!==undefined)this.emit("removeListener",type,originalListener||listener)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(events===undefined)return this;if(events.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(events[type]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete events[type]}return this}if(arguments.length===0){var keys=Object.keys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}listeners=events[type];if(typeof listeners==="function"){this.removeListener(type,listeners)}else if(listeners!==undefined){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}return this};function _listeners(target,type,unwrap){var events=target._events;if(events===undefined)return[];var evlistener=events[type];if(evlistener===undefined)return[];if(typeof evlistener==="function")return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,true)};EventEmitter.prototype.rawListeners=function rawListeners(type){return _listeners(this,type,false)};EventEmitter.listenerCount=function(emitter,type){if(typeof emitter.listenerCount==="function"){return emitter.listenerCount(type)}else{return listenerCount.call(emitter,type)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(type){var events=this._events;if(events!==undefined){var evlistener=events[type];if(typeof evlistener==="function"){return 1}else if(evlistener!==undefined){return evlistener.length}}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)copy[i]=arr[i];return copy}function spliceOne(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i){ret[i]=arr[i].listener||arr[i]}return ret}function once(emitter,name){return new Promise((function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver);reject(err)}function resolver(){if(typeof emitter.removeListener==="function"){emitter.removeListener("error",errorListener)}resolve([].slice.call(arguments))}eventTargetAgnosticAddListener(emitter,name,resolver,{once:true});if(name!=="error"){addErrorHandlerIfEventEmitter(emitter,errorListener,{once:true})}}))}function addErrorHandlerIfEventEmitter(emitter,handler,flags){if(typeof emitter.on==="function"){eventTargetAgnosticAddListener(emitter,"error",handler,flags)}}function eventTargetAgnosticAddListener(emitter,name,listener,flags){if(typeof emitter.on==="function"){if(flags.once){emitter.once(name,listener)}else{emitter.on(name,listener)}}else if(typeof emitter.addEventListener==="function"){emitter.addEventListener(name,(function wrapListener(arg){if(flags.once){emitter.removeEventListener(name,wrapListener)}listener(arg)}))}else{throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _node_modules_val_loader_dist_cjs_js_key_uiActions_osd_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9);var _node_modules_val_loader_dist_cjs_js_key_uiActions_osd_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_val_loader_dist_cjs_js_key_uiActions_osd_ui_shared_deps_public_path_module_creator_js__WEBPACK_IMPORTED_MODULE_0__);__osdBundles__.define("plugin/uiActions/public",__webpack_require__,10)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__osdPublicPath__["uiActions"]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));__webpack_require__.d(__webpack_exports__,"UiActionsSetup",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"UiActionsStart",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"UiActionsServiceParams",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"UiActionsService",(function(){return ui_actions_service_UiActionsService}));__webpack_require__.d(__webpack_exports__,"Action",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"UiActionsActionDefinition",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"createAction",(function(){return createAction}));__webpack_require__.d(__webpack_exports__,"IncompatibleActionError",(function(){return incompatible_action_error_IncompatibleActionError}));__webpack_require__.d(__webpack_exports__,"buildContextMenuForActions",(function(){return buildContextMenuForActions}));__webpack_require__.d(__webpack_exports__,"UiActionsPresentable",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"UiActionsPresentableGrouping",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"Trigger",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"TriggerContext",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"SELECT_RANGE_TRIGGER",(function(){return SELECT_RANGE_TRIGGER}));__webpack_require__.d(__webpack_exports__,"selectRangeTrigger",(function(){return selectRangeTrigger}));__webpack_require__.d(__webpack_exports__,"VALUE_CLICK_TRIGGER",(function(){return VALUE_CLICK_TRIGGER}));__webpack_require__.d(__webpack_exports__,"valueClickTrigger",(function(){return valueClickTrigger}));__webpack_require__.d(__webpack_exports__,"APPLY_FILTER_TRIGGER",(function(){return APPLY_FILTER_TRIGGER}));__webpack_require__.d(__webpack_exports__,"applyFilterTrigger",(function(){return applyFilterTrigger}));__webpack_require__.d(__webpack_exports__,"VISUALIZE_FIELD_TRIGGER",(function(){return VISUALIZE_FIELD_TRIGGER}));__webpack_require__.d(__webpack_exports__,"visualizeFieldTrigger",(function(){return visualizeFieldTrigger}));__webpack_require__.d(__webpack_exports__,"VISUALIZE_GEO_FIELD_TRIGGER",(function(){return VISUALIZE_GEO_FIELD_TRIGGER}));__webpack_require__.d(__webpack_exports__,"visualizeGeoFieldTrigger",(function(){return visualizeGeoFieldTrigger}));__webpack_require__.d(__webpack_exports__,"EXTERNAL_ACTION_TRIGGER",(function(){return EXTERNAL_ACTION_TRIGGER}));__webpack_require__.d(__webpack_exports__,"externalActionTrigger",(function(){return externalActionTrigger}));__webpack_require__.d(__webpack_exports__,"TriggerContextMapping",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"TriggerId",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ActionContextMapping",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ActionType",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"VisualizeFieldContext",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ACTION_VISUALIZE_FIELD",(function(){return ACTION_VISUALIZE_FIELD}));__webpack_require__.d(__webpack_exports__,"ACTION_VISUALIZE_GEO_FIELD",(function(){return ACTION_VISUALIZE_GEO_FIELD}));__webpack_require__.d(__webpack_exports__,"ACTION_VISUALIZE_LENS_FIELD",(function(){return ACTION_VISUALIZE_LENS_FIELD}));__webpack_require__.d(__webpack_exports__,"ActionByType",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ActionDefinitionByType",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ActionExecutionContext",(function(){return undefined}));__webpack_require__.d(__webpack_exports__,"ActionExecutionMeta",(function(){return undefined}));var public_=__webpack_require__(2);function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class action_internal_ActionInternal{constructor(definition){this.definition=definition;_defineProperty(this,"id",this.definition.id);_defineProperty(this,"type",this.definition.type||"");_defineProperty(this,"order",this.definition.order||0);_defineProperty(this,"MenuItem",this.definition.MenuItem);_defineProperty(this,"ReactMenuItem",this.MenuItem?Object(public_["uiToReactComponent"])(this.MenuItem):undefined);_defineProperty(this,"grouping",this.definition.grouping)}execute(context){return this.definition.execute(context)}getIconType(context){if(!this.definition.getIconType)return undefined;return this.definition.getIconType(context)}getDisplayName(context){if(!this.definition.getDisplayName)return`Action: ${this.id}`;return this.definition.getDisplayName(context)}getDisplayNameTooltip(context){if(!this.definition.getDisplayNameTooltip)return"";return this.definition.getDisplayNameTooltip(context)}async isCompatible(context){if(!this.definition.isCompatible)return true;return await this.definition.isCompatible(context)}async getHref(context){if(!this.definition.getHref)return undefined;return await this.definition.getHref(context)}async shouldAutoExecute(context){if(!this.definition.shouldAutoExecute)return false;return this.definition.shouldAutoExecute(context)}}function createAction(action){return{getIconType:()=>undefined,order:0,id:action.type,isCompatible:()=>Promise.resolve(true),getDisplayName:()=>"",...action}}var external_osdSharedDeps_OsdI18n_=__webpack_require__(0);function incompatible_action_error_defineProperty(obj,key,value){key=incompatible_action_error_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function incompatible_action_error_toPropertyKey(arg){var key=incompatible_action_error_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function incompatible_action_error_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class incompatible_action_error_IncompatibleActionError extends Error{constructor(){super(external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.errors.incompatibleAction",{defaultMessage:"Action is incompatible"}));incompatible_action_error_defineProperty(this,"code","INCOMPATIBLE_ACTION")}}function trigger_contract_defineProperty(obj,key,value){key=trigger_contract_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function trigger_contract_toPropertyKey(arg){var key=trigger_contract_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function trigger_contract_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class TriggerContract{constructor(internal){this.internal=internal;trigger_contract_defineProperty(this,"id",void 0);trigger_contract_defineProperty(this,"title",void 0);trigger_contract_defineProperty(this,"description",void 0);trigger_contract_defineProperty(this,"exec",async context=>{await this.internal.execute(context)});this.id=this.internal.trigger.id;this.title=this.internal.trigger.title;this.description=this.internal.trigger.description}}function trigger_internal_defineProperty(obj,key,value){key=trigger_internal_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function trigger_internal_toPropertyKey(arg){var key=trigger_internal_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function trigger_internal_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class trigger_internal_TriggerInternal{constructor(service,trigger){this.service=service;this.trigger=trigger;trigger_internal_defineProperty(this,"contract",new TriggerContract(this))}async execute(context){const triggerId=this.trigger.id;const actions=await this.service.getTriggerCompatibleActions(triggerId,context);await Promise.all([actions.map(action=>this.service.executionService.execute({action:action,context:context,trigger:this.trigger}))])}}var external_osdSharedDeps_Lodash_=__webpack_require__(3);var external_osdSharedDeps_Lodash_default=__webpack_require__.n(external_osdSharedDeps_Lodash_);var opensearchDashboardsUtils_public_=__webpack_require__(6);var external_osdSharedDeps_React_=__webpack_require__(1);var external_osdSharedDeps_React_default=__webpack_require__.n(external_osdSharedDeps_React_);const defaultTitle=external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.actionPanel.title",{defaultMessage:"Options"});const txtMore=external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.actionPanel.more",{defaultMessage:"More"});const onClick=(action,context,close)=>event=>{if(event.currentTarget instanceof HTMLAnchorElement){if(!event.defaultPrevented&&event.button===0&&(!event.currentTarget.target||event.currentTarget.target==="_self")&&!(event.metaKey||event.altKey||event.ctrlKey||event.shiftKey)){event.preventDefault();action.execute(context)}}else action.execute(context);close()};const wrapMainPanelItemsIntoSubmenu=(panels,id)=>{const panel=panels[id];if(!panel)return;const maxItemsBeforeWrapping=4;if(!panel.items)return;if(panel.items.length<=maxItemsBeforeWrapping)return;const visibleItems=panel.items.slice(0,3);const itemsInSubmenu=panel.items.slice(3);const morePanelId=panel.id+"__more";const more={name:txtMore,panel:morePanelId,icon:"boxesHorizontal","data-test-subj":`embeddablePanelMore-${id}`,_order:-1};panel.items=[...visibleItems,more];const subPanel={id:morePanelId,title:panel.title||defaultTitle,items:itemsInSubmenu};panels[morePanelId]=subPanel};const removeItemMetaFields=items=>{const euiItems=[];for(const item of items){const{_order:omit,_title:omit2,...rest}=item;euiItems.push(rest)}return euiItems};const removePanelMetaFields=panels=>{const euiPanels=[];for(const panel of panels){const{_level:omit,_icon:omit2,_category:omit3,_order:omit4,...rest}=panel;euiPanels.push({...rest,items:removeItemMetaFields(rest.items)})}return euiPanels};async function buildContextMenuForActions(_ref){let{actions:actions,title:title=defaultTitle,closeMenu:closeMenu=(()=>{})}=_ref;const panels={mainMenu:{id:"mainMenu",title:title,items:[]}};const promises=actions.map(async item=>{const{action:action}=item;const context={...item.context,trigger:item.trigger};const isCompatible=await item.action.isCompatible(context);if(!isCompatible)return;let parentGroupId="";if(action.grouping){for(let i=0;i<action.grouping.length;i++){const group=action.grouping[i];const groupId=group.id;if(!panels[groupId]){const name=group.getDisplayName?group.getDisplayName(context):group.id;panels[groupId]={id:groupId,title:name,items:[],_level:i,_icon:group.getIconType?group.getIconType(context):"empty",_category:group.category,_order:group.order};if(parentGroupId){panels[parentGroupId].items.push({name:name,panel:groupId,icon:group.getIconType?group.getIconType(context):"empty",_order:group.order||0,_title:group.getDisplayName?group.getDisplayName(context):""})}}parentGroupId=groupId}}panels[parentGroupId||"mainMenu"].items.push({name:action.MenuItem?external_osdSharedDeps_React_["createElement"](Object(public_["uiToReactComponent"])(action.MenuItem),{context:context}):action.getDisplayName(context),icon:action.getIconType(context),"data-test-subj":`embeddablePanelAction-${action.id}`,onClick:onClick(action,context,closeMenu),href:action.getHref?await action.getHref(context):undefined,_order:action.order||0,_title:action.getDisplayName(context)})});await Promise.all(promises);for(const panel of Object.values(panels)){const items=panel.items.filter(Boolean);panel.items=external_osdSharedDeps_Lodash_default.a.sortBy(items,a=>{var _a$_order;return-1*((_a$_order=a._order)!==null&&_a$_order!==void 0?_a$_order:0)},a=>a._title)}wrapMainPanelItemsIntoSubmenu(panels,"mainMenu");const categories={};for(const panel of Object.values(panels)){if(panel._level!==0){continue}if(panel._category){if(!categories[panel._category]){categories[panel._category]=[]}if(panel.items.length>1){categories[panel._category].push({order:panel._order,items:[{name:panel.title||panel.id,icon:panel._icon||"empty",panel:panel.id}]})}else{categories[panel._category].push({order:panel._order||0,items:panel.items})}}else{if(panels.mainMenu.items.length){panels.mainMenu.items.push({isSeparator:true,key:`${panel.id}separator`})}if(panel.items.length>1){panels.mainMenu.items.push({name:panel.title||panel.id,icon:panel._icon||"empty",panel:panel.id})}else{panels.mainMenu.items.push(...panel.items)}}}Object.keys(categories).forEach(key=>{const sortedEntries=categories[key].sort((a,b)=>b.order-a.order);const sortedItems=sortedEntries.reduce((items,category)=>[...items,...category.items],[]);if(panels.mainMenu.items.length){panels.mainMenu.items.push({isSeparator:true,key:`${key}separator`})}panels.mainMenu.items.push(...sortedItems)});const panelList=Object.values(panels);return removePanelMetaFields(panelList)}var external_osdSharedDeps_ElasticEui_=__webpack_require__(4);var events=__webpack_require__(7);var external_osdSharedDeps_ReactDom_=__webpack_require__(5);var external_osdSharedDeps_ReactDom_default=__webpack_require__.n(external_osdSharedDeps_ReactDom_);let activeSession=null;const CONTAINER_ID="contextMenu-container";function createInteractionPositionTracker(){let lastMouseX=0;let lastMouseY=0;const lastClicks=[];const MAX_LAST_CLICKS=10;document.addEventListener("mouseup",onClick,true);document.addEventListener("click",onClick,true);document.addEventListener("mousemove",onMouseUpdate,{passive:true});document.addEventListener("mouseenter",onMouseUpdate,{passive:true});function onClick(event){lastClicks.push({el:event.target,mouseX:event.clientX,mouseY:event.clientY});if(lastClicks.length>MAX_LAST_CLICKS){lastClicks.shift()}}function onMouseUpdate(event){lastMouseX=event.clientX;lastMouseY=event.clientY}return{resolveLastPosition:()=>{const lastClick=[...lastClicks].reverse().find(_ref=>{let{el:el}=_ref;return el&&document.body.contains(el)});if(!lastClick){return{x:lastMouseX,y:lastMouseY}}const{top:top,left:left,bottom:bottom,right:right}=lastClick.el.getBoundingClientRect();const mouseX=lastClick.mouseX;const mouseY=lastClick.mouseY;if(top<=mouseY&&bottom>=mouseY&&left<=mouseX&&right>=mouseX){return{x:mouseX,y:mouseY}}else{return{x:left+(right-left)/2,y:bottom}}}}}const{resolveLastPosition:resolveLastPosition}=createInteractionPositionTracker();function getOrCreateContainerElement(){let container=document.getElementById(CONTAINER_ID);let{x:x,y:y}=resolveLastPosition();y=y+window.scrollY;x=x+window.scrollX;if(!container){container=document.createElement("div");container.style.left=x+"px";container.style.top=y+"px";container.style.position="absolute";container.style.zIndex="9999";container.id=CONTAINER_ID;document.body.appendChild(container)}else{container.style.left=x+"px";container.style.top=y+"px"}return container}class open_context_menu_ContextMenuSession extends events["EventEmitter"]{close(){if(activeSession===this){const container=document.getElementById(CONTAINER_ID);if(container){external_osdSharedDeps_ReactDom_default.a.unmountComponentAtNode(container);this.emit("closed")}}}}function openContextMenu(panels){let props=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(activeSession){activeSession.close()}const container=getOrCreateContainerElement();const session=activeSession=new open_context_menu_ContextMenuSession;const onClose=()=>{if(props.onClose){props.onClose()}session.close()};external_osdSharedDeps_ReactDom_default.a.render(external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiPopover"],{className:"embPanel__optionsMenuPopover",button:container,isOpen:true,closePopover:onClose,panelPaddingSize:"none",anchorPosition:"downRight",ownFocus:true},external_osdSharedDeps_React_default.a.createElement(external_osdSharedDeps_ElasticEui_["EuiContextMenu"],{initialPanelId:"mainMenu",panels:panels,"data-test-subj":props["data-test-subj"]})),container);return session}function ui_actions_execution_service_defineProperty(obj,key,value){key=ui_actions_execution_service_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function ui_actions_execution_service_toPropertyKey(arg){var key=ui_actions_execution_service_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function ui_actions_execution_service_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class ui_actions_execution_service_UiActionsExecutionService{constructor(){ui_actions_execution_service_defineProperty(this,"batchingQueue",[]);ui_actions_execution_service_defineProperty(this,"pendingTasks",new Set)}async execute(_ref){var _await$action$shouldA,_action$shouldAutoExe;let{action:action,context:context,trigger:trigger}=_ref;const shouldBatch=(_await$action$shouldA=!await((_action$shouldAutoExe=action.shouldAutoExecute)===null||_action$shouldAutoExe===void 0?void 0:_action$shouldAutoExe.call(action,{...context,trigger:trigger})))!==null&&_await$action$shouldA!==void 0?_await$action$shouldA:false;const task={action:action,context:context,trigger:trigger,defer:Object(opensearchDashboardsUtils_public_["defer"])()};if(shouldBatch){this.batchingQueue.push(task)}else{this.pendingTasks.add(task);try{await action.execute({...context,trigger:trigger});this.pendingTasks.delete(task)}catch(e){this.pendingTasks.delete(task);throw new Error(e)}}this.scheduleFlush();return task.defer.promise}scheduleFlush(){setTimeout(()=>{if(this.pendingTasks.size===0){const tasks=Object(external_osdSharedDeps_Lodash_["uniqBy"])(this.batchingQueue,t=>t.action.id);if(tasks.length===1){this.executeSingleTask(tasks[0])}if(tasks.length>1){this.executeMultipleActions(tasks)}this.batchingQueue.splice(0,this.batchingQueue.length)}},0)}async executeSingleTask(_ref2){let{context:context,action:action,defer:defer,trigger:trigger}=_ref2;try{await action.execute({...context,trigger:trigger});defer.resolve()}catch(e){defer.reject(e)}}async executeMultipleActions(tasks){const panels=await buildContextMenuForActions({actions:tasks.map(_ref3=>{let{action:action,context:context,trigger:trigger}=_ref3;return{action:action,context:context,trigger:trigger}}),title:"",closeMenu:()=>{tasks.forEach(t=>t.defer.resolve());session.close()}});const session=openContextMenu(panels,{"data-test-subj":"multipleActionsContextMenu"})}}function ui_actions_service_defineProperty(obj,key,value){key=ui_actions_service_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function ui_actions_service_toPropertyKey(arg){var key=ui_actions_service_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function ui_actions_service_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class ui_actions_service_UiActionsService{constructor(){let{triggers:_triggers=new Map,actions:_actions=new Map,triggerToActions:_triggerToActions=new Map}=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};ui_actions_service_defineProperty(this,"executionService",new ui_actions_execution_service_UiActionsExecutionService);ui_actions_service_defineProperty(this,"triggers",void 0);ui_actions_service_defineProperty(this,"actions",void 0);ui_actions_service_defineProperty(this,"triggerToActions",void 0);ui_actions_service_defineProperty(this,"registerTrigger",trigger=>{if(this.triggers.has(trigger.id)){throw new Error(`Trigger [trigger.id = ${trigger.id}] already registered.`)}const triggerInternal=new trigger_internal_TriggerInternal(this,trigger);this.triggers.set(trigger.id,triggerInternal);this.triggerToActions.set(trigger.id,[])});ui_actions_service_defineProperty(this,"getTrigger",triggerId=>{const trigger=this.triggers.get(triggerId);if(!trigger){throw new Error(`Trigger [triggerId = ${triggerId}] does not exist.`)}return trigger.contract});ui_actions_service_defineProperty(this,"getTriggers",()=>this.triggers);ui_actions_service_defineProperty(this,"registerAction",definition=>{if(this.actions.has(definition.id)){throw new Error(`Action [action.id = ${definition.id}] already registered.`)}const action=new action_internal_ActionInternal(definition);this.actions.set(action.id,action);return action});ui_actions_service_defineProperty(this,"unregisterAction",actionId=>{if(!this.actions.has(actionId)){throw new Error(`Action [action.id = ${actionId}] is not registered.`)}this.actions.delete(actionId)});ui_actions_service_defineProperty(this,"hasAction",actionId=>this.actions.has(actionId));ui_actions_service_defineProperty(this,"attachAction",(triggerId,actionId)=>{const trigger=this.triggers.get(triggerId);if(!trigger){throw new Error(`No trigger [triggerId = ${triggerId}] exists, for attaching action [actionId = ${actionId}].`)}const actionIds=this.triggerToActions.get(triggerId);if(!actionIds.find(id=>id===actionId)){this.triggerToActions.set(triggerId,[...actionIds,actionId])}});ui_actions_service_defineProperty(this,"detachAction",(triggerId,actionId)=>{const trigger=this.triggers.get(triggerId);if(!trigger){throw new Error(`No trigger [triggerId = ${triggerId}] exists, for detaching action [actionId = ${actionId}].`)}const actionIds=this.triggerToActions.get(triggerId);this.triggerToActions.set(triggerId,actionIds.filter(id=>id!==actionId))});ui_actions_service_defineProperty(this,"addTriggerAction",(triggerId,action)=>{if(!this.actions.has(action.id))this.registerAction(action);this.attachAction(triggerId,action.id)});ui_actions_service_defineProperty(this,"getAction",id=>{if(!this.actions.has(id)){throw new Error(`Action [action.id = ${id}] not registered.`)}return this.actions.get(id)});ui_actions_service_defineProperty(this,"getTriggerActions",triggerId=>{this.getTrigger(triggerId);const actionIds=this.triggerToActions.get(triggerId);const actions=actionIds.map(actionId=>this.actions.get(actionId)).filter(Boolean);return actions});ui_actions_service_defineProperty(this,"getTriggerCompatibleActions",async(triggerId,context)=>{const actions=this.getTriggerActions(triggerId);const isCompatibles=await Promise.all(actions.map(action=>action.isCompatible({...context,trigger:this.getTrigger(triggerId)})));return actions.reduce((acc,action,i)=>isCompatibles[i]?[...acc,action]:acc,[])});ui_actions_service_defineProperty(this,"executeTriggerActions",async(triggerId,context)=>{const trigger=this.getTrigger(triggerId);await trigger.exec(context)});ui_actions_service_defineProperty(this,"clear",()=>{this.actions.clear();this.triggers.clear();this.triggerToActions.clear()});ui_actions_service_defineProperty(this,"fork",()=>{const triggers=new Map;const actions=new Map;const triggerToActions=new Map;for(const[key,value]of this.triggers.entries())triggers.set(key,value);for(const[key,value]of this.actions.entries())actions.set(key,value);for(const[key,value]of this.triggerToActions.entries())triggerToActions.set(key,[...value]);return new ui_actions_service_UiActionsService({triggers:triggers,actions:actions,triggerToActions:triggerToActions})});this.triggers=_triggers;this.actions=_actions;this.triggerToActions=_triggerToActions}}const SELECT_RANGE_TRIGGER="SELECT_RANGE_TRIGGER";const selectRangeTrigger={id:SELECT_RANGE_TRIGGER,title:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.selectRangeTitle",{defaultMessage:"Range selection"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.selectRangeDescription",{defaultMessage:"A range of values on the visualization"})};const VALUE_CLICK_TRIGGER="VALUE_CLICK_TRIGGER";const valueClickTrigger={id:VALUE_CLICK_TRIGGER,title:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.valueClickTitle",{defaultMessage:"Single click"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.valueClickDescription",{defaultMessage:"A data point click on the visualization"})};const APPLY_FILTER_TRIGGER="FILTER_TRIGGER";const applyFilterTrigger={id:APPLY_FILTER_TRIGGER,title:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.applyFilterTitle",{defaultMessage:"Apply filter"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.applyFilterDescription",{defaultMessage:"When OpenSearch Dashboards filter is applied. Could be a single value or a range filter."})};const VISUALIZE_FIELD_TRIGGER="VISUALIZE_FIELD_TRIGGER";const visualizeFieldTrigger={id:VISUALIZE_FIELD_TRIGGER,title:"Visualize field",description:"Triggered when user wants to visualize a field."};const VISUALIZE_GEO_FIELD_TRIGGER="VISUALIZE_GEO_FIELD_TRIGGER";const visualizeGeoFieldTrigger={id:VISUALIZE_GEO_FIELD_TRIGGER,title:"Visualize Geo field",description:"Triggered when user wants to visualize a geo field."};const EXTERNAL_ACTION_TRIGGER="EXTERNAL_ACTION_TRIGGER";const externalActionTrigger={id:EXTERNAL_ACTION_TRIGGER,title:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.externalActionTitle",{defaultMessage:"Single click"}),description:external_osdSharedDeps_OsdI18n_["i18n"].translate("uiActions.triggers.externalActionDescription",{defaultMessage:"A data point click on the visualization used to trigger external action like show flyout, etc."})};const DEFAULT_TRIGGER="";const defaultTrigger={id:DEFAULT_TRIGGER,title:"Unknown",description:"Unknown trigger."};function plugin_defineProperty(obj,key,value){key=plugin_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function plugin_toPropertyKey(arg){var key=plugin_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function plugin_toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}class plugin_UiActionsPlugin{constructor(initializerContext){plugin_defineProperty(this,"service",new ui_actions_service_UiActionsService)}setup(core){this.service.registerTrigger(selectRangeTrigger);this.service.registerTrigger(valueClickTrigger);this.service.registerTrigger(applyFilterTrigger);this.service.registerTrigger(visualizeFieldTrigger);this.service.registerTrigger(visualizeGeoFieldTrigger);return this.service}start(core){return this.service}stop(){this.service.clear()}}const DEFAULT_ACTION="";const ACTION_VISUALIZE_FIELD="ACTION_VISUALIZE_FIELD";const ACTION_VISUALIZE_GEO_FIELD="ACTION_VISUALIZE_GEO_FIELD";const ACTION_VISUALIZE_LENS_FIELD="ACTION_VISUALIZE_LENS_FIELD";function public_plugin(initializerContext){return new plugin_UiActionsPlugin(initializerContext)}}]);